<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<h1>Netcdf-Java FAQ</h1>
<h3>Logging</h3>
<p><strong>Q: How do I get rid of the message &quot;log4j:WARN No appenders could be found for logger (ucar.nc2.NetcdfFile).  log4j:WARN Please initialize the log4j system properly&quot; ?</strong></p>
<blockquote>
  <p>Add the following to your startup code:</p>
  <pre wrap="">
    org.apache.log4j.BasicConfigurator.configure();
    org.apache.log4j.Logger logger = org.apache.log4j.Logger.getRootLogger();
    logger.setLevel(org.apache.log4j.Level.OFF)</pre>
  </blockquote>
<h3>Caching</h3>
<p><strong>Q: How do I turn on NetcdfFile caching</strong>?</p>
<blockquote>
  <p>Initialize with <strong>NetcdfDataset.initNetcdfFileCache()</strong>, then open files through <strong>NetcdfDataset.acquireFile() </strong>and<strong> NetcdfDataset.acquireDataset()</strong>. Note that you always close a file in the normal way, ie through <strong>NetcdfFile.close()</strong>. See the javadoc for those methods for more details. </p>
</blockquote>
<h3>Multithreading</h3>
<p><strong>Q: Is the Netcdf-Java library thread-safe?</strong></p>
<blockquote>
  <p> Underneath a <strong>Variable/NetcdfFile</strong> is (usually) a <strong>java.io.RandomAccessFile</strong> object, which is not thread-safe, because  it keeps the state of the file position. So even if all you want to do is read data in multiple threads, you need to synchronize, typically on the <strong>NetcdFile</strong> object. Alternatively, open a new <strong>NetcdfFile</strong> for each thread. The THREDDS Data Server (TDS) uses a cache of open <strong>NetcdfFile</strong> files by using the <strong>NetcdfDataset.acquireFile() </strong>method, which allows stateless handling of data requests minimizing file opening and closing.</p>
</blockquote>
<p><strong>Q: Do I need to synchronize if I use NetcdfDataset.acquireFile()?</strong></p>
<blockquote>
  <p wrap="">The way that the cache is designed to work is that you get back a NetcdfFile object, which should then used only in a single thread so you dont need synchronization (&quot;thread-confinement&quot;), such as to answer a single request in a server. Until you release that NetcdfFile object, no one else can get it from the cache. If another request is made for that same NetcdfFile while its locked, a new NetcdfFile is opened.     And of course, the cache itself is thread-safe. So if you use it properly, you never have to do synchronization yourself.</p>
</blockquote>
<p>&nbsp;</p>
<h3>&nbsp;</h3>
<blockquote>&nbsp;</blockquote>
<hr />
<address>
<img src="../nc.gif" alt="" width="64" height="64" /> This document is maintained by <a href="mailto:caron@unidata.ucar.edu">John Caron</a> and was last updated on Dec 29, 2008
</address>
</body>
</html>
