<html>
<head>
<title>Upgrading Tomcat and the TDS</title>

</head>

<body>
<p>

For this tutorial it is assumed that apache-tomcat-5.5.17.tar.gz is the old
distribution and the new one is apache-tomcat-5.5.25.tar.gz. These steps are
done as user tomcat.

<pre>

- Go to tomcat home directory
% cd ~tomcat

- Get tomcat5 distribution ie apache-tomcat-5.5.25.tar.gz from: 
	<a href="http://tomcat.apache.org">Apache Tomcat</a>

- Unpack distribution  
% tar xzvf apache-tomcat-5.5.25.tar.gz

<!--
- Remove/Make link from distribution directory to runtime
% cd ~tomcat
% rm runtime
% ln -s apache-tomcat-5.5.25 runtime
now /home/tomcat/runtime/ points to /home/tomcat/runtime/apache-tomcat-5.5.25
//-->

- Distribution directories should look like:
% ls apache-tomcat-5.5.25
logs/           NOTICE          server/
conf/           RUNNING.txt     RELEASE-NOTES
bin/            work/           common/
webapps/        LICENSE         shared/


- Go to bin directory and save original *sh in dist. If there isn't much change
  in the *sh scripts, one can copy them from the old distribution
% cd /home/tomcat/apache-tomcat-5.5.25/bin
% mkdir dist
% cp *sh dist
% cp /home/tomcat/apache-tomcat-5.5.17/bin/*sh .

The scripts need minor editing because the version has changed from:
apache-tomcat-5.5.17 -> apache-tomcat-5.5.25
edit *sh making the version changes.

- If you have changed users-tomcat.xml, you can copy the old version to the 
  new /home/tomcat/apache-tomcat-5.5.25/conf.
% cd /home/tomcat/apache-tomcat-5.5.25/conf
% cp /opt/apache-tomcat-5.5.17/conf/users-tomcat.xml .

</pre>
<p>
- If you have changed server.xml, and you are moving to a new major version of 
tomcat (eg 5.0 to 5.5), you must manually change the new 
/home/tomcat/apache-tomcat-5.5.25/conf/server.xml using instructions at: <a href="../remote/remote.html">RemoteManagement</a> , do not copy the 
old file. For minor version upgrades (eg 5.5.17 to 5.5.25), you can probably 
just copy the old file.
<pre>
% cd /home/tomcat/apache-tomcat-5.5.25/conf
% cp /home/tomcat/apache-tomcat-5.5.17/conf/server.xml .

- Copy old configurations (content directory) over to the new configurations place.
% cd /home/tomcat/apache-tomcat-5.5.25
% cp -r /home/tomcat/apache-tomcat-5.5.17/content .

- Copy the SSL keystore file over to new distribution.
% cp /home/tomcat/apache-tomcat-5.5.17/.keystore .

- Copy or download thredds.war to /home/tomcat/apache-tomcat-5.5.25/webapps.
% cd /home/tomcat/apache-tomcat-5.5.25/webapps
% cp /home/tomcat/apache-tomcat-5.5.17/webapps/thredds.war .
 or
 download latest <a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/ind
ex.html#TDS">thredds.war</a>

- Stop tomcat
% cd /home/tomcat/apache-tomcat-5.5.17/bin
% ./shutdown.sh

- Start tomcat
% cd /home/tomcat/apache-tomcat-5.5.25/bin
% ./startup.sh


</pre>

</body>
</html>
