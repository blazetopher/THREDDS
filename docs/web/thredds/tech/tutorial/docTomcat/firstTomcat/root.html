<html>
<head>
<title>Steps done as root</title>
  <link rel="stylesheet" type="text/css" href="../default.css" title="Style">

</head>

<body>
<a href="overview.html"><img src="../images/PreviousArrow.gif" border="0"   alt="Previous: Overview" title="Previous: Overview"></a> <a href="tomcat.html"><img src="../images/NextArrow.gif" border="0"   alt="Next: Steps done as user tomcat" title="Next: Steps done as user tomcat"></a>  <a href="../toc.html"><img src="../images/TOCIcon.gif" border="0"   alt="Table of contents" title="Table of contents"></a> <a href="../mainindex.html"><img src="../images/Index.gif" border="0"   alt="Index" title="Index"></a>  <a href="../glossary.html"><img src="../images/Glossary.gif" border="0"   alt="Glossary" title="Glossary"></a>   <a href="../imageindex.html"><img src="../images/Images.gif" border="0"   alt="Images" title="Images"></a>      <a href="../frames.html" target="_top"><img src="../images/Frames.gif" border="0"   alt="Frames" title="Frames"></a> 
<span class="breadcrumb"><a href="../index.html">Tomcat & THREDDS Data Server installation and configuration</a>  > <a href="index.html">First time Tomcat installation</a>  </span>
<br>
<img src="../images/blueline.gif">
<p>
<div class="pagetitle">1.1 Steps done as root</div>


<p>
<h2> Run as Unprivileged User</h2>
<p>

By default, Tomcat runs on port 8080 and therefore does not require root to run.
Its important not to run as root. Create a special user, e.g. named "tomcat", 
which owns everything under ${tomcat_home}, and change to that user to run 
Tomcat. This special user will need read/write access to ${tomcat_home} and 
its subdirectories, and read access to your data directories. Don't give the 
tomcat user any rights in any other directories. If your operating system 
allows it (e.g. Unix, Linux), you might also not allow the tomcat user to log 
in directly. You would log in as yourself, then switch to being the 
tomcat user using the sudo command. One should create a tomcat group and then
use the 
<a href="http://linux.about.com/od/commands/l/blcmdl8_adduser.htm">adduser</a>
 command to make the user tomcat.
<pre>

% group -c tomcat
% adduser tomcat -u 49 -d /opt/tomcat -g tomcat

</pre>
<h2> Use a Firewall</h2>
<p>

Unless you are on a private network, you need a firewall. A firewall restricts 
who is allowed to access network ports. Make the default setting to disallow 
all accesses, then enable just the ones that are needed.

<p>
    <li> Port 8080 should have unrestricted access.
<p>
    <li> If you are allowing remote management, you must also open up port 8443. (recommended)
<p>
    <li> Tomcat also uses port 8005 to enable shutdown. However, shutdown can only
      be run from the same machine as Tomcat is running. As long as 
      untrusted users aren't running on your server machine, you shouldn't 
      have to worry about this port being open. However, you might want to 
      restrict public access to it so hackers aren't tempted.
<p>
    <li> If you are also using Tomcat in conjunction with another web server like 
      Apache to handle servlet/JSP requests, you need to allow that server 
      access to port 8009, but typically that can be restricted to accesses on 
      the same machine or at least on your subnet. If you are running Tomcat 
      only standalone (e.g. only running the THREDDS data server) then disable 
      port 8009 in ${tomcat_home}/conf/server.xml file.
<p>
<pre>
Firewall file: /etc/sysconfig/iptables


*filter
:INPUT ACCEPT [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
:EXTERNAL - [0:0]
:INSTRUCTOR - [0:0]
:WORKSHOP - [0:0]
#
# Route INPUT to appropriate bins
#
-A INPUT -i lo -j ACCEPT
-A INPUT -p icmp --icmp-type any -j ACCEPT
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -s 128.117.47.150/32 -j ACCEPT
-A INPUT -s 128.117.47.169/32 -j INSTRUCTOR
-A INPUT -s 128.117.140.0/24 -j INSTRUCTOR
-A INPUT -s 128.117.156.0/24 -j INSTRUCTOR
-A INPUT -s 128.117.47.0/24 -j WORKSHOP
-A INPUT -j EXTERNAL
#
# Handle instructor connections
#
-A INSTRUCTOR -m state --state NEW -p tcp --dport 22 -j ACCEPT
-A INSTRUCTOR -m state --state NEW -p tcp --dport 5900 -j ACCEPT
-A INSTRUCTOR -j WORKSHOP
#
# Handle workshop connections
#
-A WORKSHOP -m state --state NEW -p tcp --dport 388 -j ACCEPT
-A WORKSHOP -m state --state NEW -p tcp --dport 8080 -j ACCEPT
-A WORKSHOP -m state --state NEW -p tcp --dport 8443 -j ACCEPT
-A WORKSHOP -j EXTERNAL
#
# Handle external connections
#
-A EXTERNAL -j REJECT
#
# Mark outgoing packets for keeping state
#
-A OUTPUT -d 127.0.0.1 -j ACCEPT
-A OUTPUT -m state --state NEW -p tcp -j ACCEPT
-A OUTPUT -m state --state NEW -p udp -j ACCEPT
COMMIT
</pre>
<h2> Resources</h2>
<p>

<a href="http://www.physics.umd.edu/pnce/user-docs/Linux/firewall.html">Linux Firewall Tips</a>
<p>
<a href="http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch14_:_Linux_Firewalls_Using_iptables">HOWTO Firewall</a>
<p>

<p>
<div  class="childlist" ><table  width="100%" ></table></div>
<p>&nbsp;<p>
<img src="../images/blueline.gif">
<br>
<a href="overview.html"><img src="../images/PreviousArrow.gif" border="0"   alt="Previous: Overview" title="Previous: Overview"></a> <a href="tomcat.html"><img src="../images/NextArrow.gif" border="0"   alt="Next: Steps done as user tomcat" title="Next: Steps done as user tomcat"></a>  <a href="../toc.html"><img src="../images/TOCIcon.gif" border="0"   alt="Table of contents" title="Table of contents"></a> <a href="../mainindex.html"><img src="../images/Index.gif" border="0"   alt="Index" title="Index"></a>   <a href="../glossary.html"><img src="../images/Glossary.gif" border="0"   alt="Glossary" title="Glossary"></a>     <a href="../imageindex.html"><img src="../images/Images.gif" border="0"   alt="Images" title="Images"></a>     <a href="../frames.html" target="_top"><img src="../images/Frames.gif" border="0"   alt="Frames" title="Frames"></a> 
<span class="breadcrumb"><a href="../index.html">Tomcat & THREDDS Data Server installation and configuration</a>  > <a href="index.html">First time Tomcat installation</a>  </span>
<p>

</body>
</html>

