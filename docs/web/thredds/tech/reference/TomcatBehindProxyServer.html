<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Running Tomcat Behind a Proxy Server</title></head>
<body>
<h1><img src="../THREDDSlogo.jpg" height="54" width="67">Running Tomcat Behind a Proxy Server<br>
 </h1>
<hr>
<h2>Tomcat and Apache mod_proxy<br>
</h2>
<p>[Thanks to Michael Godin (MBARI) for the following documentation.]<br>
</p>
<p>If you are using Tomcat on port 8080 (for example) and Apache on the
default port 80, you can use the Apache proxy module to hide the Tomcat
port in the URLs used to connect to THREDDS.&nbsp; This may be critical
if your server is behind a firewall that only allows port 80
access.&nbsp; It is also important if THREDDS is running on a machine
that is completely behind a firewall, but you have a server running
Apache that can talk to the machine.</p>
<p>You will need to edit the Apache httpd.conf file (on Linux, it is stored in /etc/httpd/conf/).</p>
<p>Find the lines that start with "&lt;IfModule mod_proxy.c&gt;" and
end with "&lt;/IfModule&gt;".&nbsp; These lines may need to be
uncommented.&nbsp; Between these lines, make sure the following line
exists and is uncommented:</p>
<pre>    ProxyRequests On<br></pre>
<p>Then add the following lines:</p>
<pre>    ProxyPreserveHost On<br>    &lt;Location /thredds&gt;<br>        ProxyPass <a class="moz-txt-link-freetext" href="http://myhost.mydomain:8080/thredds">http://myhost.mydomain:8080/thredds</a><br>        ProxyPassReverse <a class="moz-txt-link-freetext" href="http://myhost.mydomain:8080/thredds">http://myhost.mydomain:8080/thredds</a><br>    &lt;/Location&gt;<br>    &lt;Proxy <a class="moz-txt-link-freetext" href="http://myhost.mydomain:8080/thredds">http://myhost.mydomain:8080/thredds</a>&gt;<br>        AllowOverride None<br>        Order allow,deny<br>        Allow from All<br>    &lt;/Proxy&gt;<br></pre>
<p>You of course need to replace "http://myhost.mydomain:8080/thredds" with the full URL of the THREDDS web application.</p>
<p>The section between &lt;Proxy... And &lt;/Proxy&gt; can usually be
omitted, but in some cases a server is sufficiently locked down that
you need to explicitly allow access to resources.&nbsp; It can also be
edited to restrict access to registered users via Apache authentication
mechanisms.</p>
<p>Finally, on the server command line (as a super/admin user), execute:</p>
<pre>    apachectl graceful<br></pre>
<p>In my configuration, I initially failed to add the line
"ProxyPreserveHost On", which caused me many headaches as links
generated by THREDDS kept directing the client back to port 8080 (which
was blocked by a firewall).<br>
</p>
<h3>Tomcat Documentation<br>
</h3>
<ul>
  <li><a href="http://tomcat.apache.org/tomcat-6.0-doc/proxy-howto.html">Tomcat 6.0 Proxy Support HOW-TO</a></li>
  <li><a href="http://tomcat.apache.org/tomcat-5.5-doc/proxy-howto.html">Tomcat 5.5 Proxy Support HOW-TO</a></li>
</ul>
<h2>Tomcat and Apache mod_jk</h2>
<p>Sounds like mod_jk is more powerful than mod_proxy. If anyone has
experience using mod_jk and could contribute some text here, please let
us know at <a href="mailto:thredds@unidata.ucar.edu">thredds@unidata.ucar.edu</a>.<br>
</p>
<h3>Tomcat Documentation</h3>
<ul>
  <li><a href="http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html">Apache Tomcat Connector - Webserver HowTo</a></li>
</ul>
<pre></pre>
<hr width="100%">
<address>
<img src="../images/thread.png" height="108" width="110">This document is maintained by Unidata and was last updated on July 10, 2007. Send comments to <a href="mailto:thredds@unidata.ucar.edu">thredds@unidata.ucar.edu</a> or <a href="mailto:support-thredds@unidata.ucar.edu">support-thredds@unidata.ucar.edu</a>.<br>
 
</address>
<p>&nbsp; </p>
</body></html>