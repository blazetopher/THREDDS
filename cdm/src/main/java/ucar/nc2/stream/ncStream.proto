package ncstream;

option java_package = "ucar.nc2.stream";
option java_outer_classname = "NcStreamProto";

message Attribute {
  required string name = 1;
  enum Type {
    STRING = 0;
    BYTE = 1;
    SHORT = 2;
    INT = 3;
    LONG = 4;
    FLOAT = 5;
    DOUBLE = 6;
  }
  required Type type = 2;
  required uint32 len = 3;
  required bytes data = 4;
}

enum AxisType {
  RunTime = 0;
  Ensemble = 1;
  Time = 2;
  GeoZ = 3;
  GeoY = 4;
  GeoX = 5;
  Lat = 6;
  Lon = 7;
  Height = 8;
  Pressure = 9;
  RadialAzimuth = 10;
  RadialDistance = 11;
  RadialElevation = 12;
}

message CoordinateSystem {
  required string name = 1;
  repeated string axes = 2;
  repeated string transform = 3;
}

message CoordinateTransform {
  required string name = 1;
  repeated Attribute atts = 2;
}

enum DataType {
  CHAR = 0;
  BYTE = 1;
  SHORT = 2;
  INT = 3;
  LONG = 4;
  FLOAT = 5;
  DOUBLE = 6;
  STRING = 7;
  STRUCTURE = 8;
  SEQUENCE = 9;
}

message Dimension {
  optional string name = 1;
  optional uint64 length = 2;
  optional bool isUnlimited = 3;
  optional bool isVlen = 4;
  optional bool isPrivate = 5;
}

message Variable {
  required string name = 1;
  required DataType dataType = 2;
  repeated Dimension shape = 3;  // actual dimension instead of reference
  repeated Attribute atts = 4;
  optional bytes data = 5;    // "immediate" - store small data in header
  optional AxisType axis = 6;
  repeated string coordSys = 7;
}

message Structure {
  required string name = 1;
  required DataType dataType = 2;
  repeated Dimension shape = 3; // actual dimension instead of reference
  repeated Attribute atts = 4;
  repeated Variable vars = 5;
  repeated Structure structs = 6;
  repeated string coordSys = 7;
}

message Group {
  required string name = 1;
  repeated Dimension dims = 2;
  repeated Variable vars = 3;
  repeated Structure structs = 4;
  repeated Attribute atts = 5;
  repeated Group groups = 6;
  repeated CoordinateSystem coordSys = 7;
  repeated CoordinateTransform coordTrans = 8;
}

message Header {
  required fixed64 indexPos = 1;
  optional string name = 2;
  required Group root = 3;
}

message Data {
  required string varName = 1;
  required DataType dataType = 2;
  required Section section = 3;
}

message Range {
  optional uint64 start = 1;
  required uint64 size = 2;
  optional uint64 stride = 3;
}

message Section {
  repeated Range range = 1;
}